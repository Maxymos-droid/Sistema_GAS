
<script>

/* ========================== UTILIDADES (LOADING, TOAST) ========================== */
/**
 * Módulo de Utilidades - Componentes UI Comuns
 * 
 * Responsabilidades:
 * - Loading overlay (mostrar/ocultar)
 * - Toast notifications (sucesso, erro, aviso, info)
 * 
 * Objetos:
 * - Loading - Controla o overlay de carregamento
 * 
 * Funções:
 * - mostrarToast(mensagem, tipo) - Mostra notificação temporária
 */

// ========== LOADING OVERLAY ==========
const Loading = {
  /**
   * Mostra o overlay de carregamento
   * @param {string} texto - Mensagem a exibir (padrão: "Carregando...")
   */
  show(texto = "Carregando...") {
    const el = document.getElementById("loading-overlay");
    const textEl = el?.querySelector('.loading-text');
    if (el) {
      el.setAttribute('aria-hidden', 'false');
      if (textEl) textEl.textContent = texto;
    }
  },
  
  /**
   * Oculta o overlay de carregamento
   */
  hide() {
    const el = document.getElementById("loading-overlay");
    if (el) el.setAttribute('aria-hidden', 'true');
  }
};

// ========== TOAST NOTIFICATIONS ==========
/**
 * Mostra uma notificação temporária (toast)
 * @param {string} mensagem - Texto da mensagem
 * @param {string} tipo - Tipo: 'success', 'error', 'warning', 'info' (padrão: 'info')
 */
function mostrarToast(mensagem, tipo = "info") {
  let container = document.getElementById("toast-container");
  if (!container) {
    container = document.createElement("div");
    container.id = "toast-container";
    document.body.appendChild(container);
  }

  const icons = {
    success: "check_circle",
    error: "error",
    warning: "warning",
    info: "info"
  };

  const toast = document.createElement("div");
  toast.className = `app-toast app-toast-${tipo}`;
  toast.innerHTML = `<i class="material-icons">${icons[tipo] || "info"}</i> <span>${mensagem}</span>`;
  container.appendChild(toast);

  // Remove após 4 segundos
  setTimeout(() => toast.remove(), 4000);
}

/**
 * Modal de confirmação genérico (Sim/Não)
 * @param {string} mensagem
 * @param {string} [titulo]
 * @param {string} [textoSim]
 * @param {string} [textoNao]
 * @returns {Promise<boolean>}
 */
function mostrarConfirmacao(mensagem, titulo = "Confirmar", textoSim = "Sim", textoNao = "Não") {
  const modal = document.getElementById("modalConfirmacao");
  const tituloEl = document.getElementById("tituloModalConfirmacao");
  const textoEl = document.getElementById("textoModalConfirmacao");
  const btnSim = document.getElementById("btnConfirmacaoSim");
  const btnNao = document.getElementById("btnConfirmacaoNao");

  if (!modal || !tituloEl || !textoEl || !btnSim || !btnNao) {
    // Fallback
    return Promise.resolve(confirm(mensagem));
  }

  tituloEl.textContent = titulo;
  textoEl.textContent = mensagem;
  btnSim.lastChild.nodeValue = ` ${textoSim}`;
  btnNao.textContent = textoNao;

  modal.classList.add("show");

  return new Promise((resolve) => {
    const cleanup = (val) => {
      modal.classList.remove("show");
      btnSim.replaceWith(btnSim.cloneNode(true));
      btnNao.replaceWith(btnNao.cloneNode(true));
      resolve(val);
    };

    const btnSimAtual = document.getElementById("btnConfirmacaoSim");
    const btnNaoAtual = document.getElementById("btnConfirmacaoNao");

    btnSimAtual.addEventListener("click", () => cleanup(true), { once: true });
    btnNaoAtual.addEventListener("click", () => cleanup(false), { once: true });
  });
}


</script>

